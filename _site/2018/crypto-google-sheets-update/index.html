<!DOCTYPE html><html lang="en-US"><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="viewport" content="width=device-width, initial-scale=1" /> <!-- Begin Jekyll SEO tag v2.8.0 --><title>CryptoCraze - Google Sheets Price Update | Where will you go next?</title><meta name="generator" content="Jekyll v3.9.2" /><meta property="og:title" content="CryptoCraze - Google Sheets Price Update" /><meta name="author" content="johnlarkin1" /><meta property="og:locale" content="en_US" /><meta name="description" content="Text messages are fun… but an excel / Google Sheets spreadsheet is also great for organization." /><meta property="og:description" content="Text messages are fun… but an excel / Google Sheets spreadsheet is also great for organization." /><link rel="canonical" href="http://localhost:4000/2018/crypto-google-sheets-update/" /><meta property="og:url" content="http://localhost:4000/2018/crypto-google-sheets-update/" /><meta property="og:site_name" content="Where will you go next?" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-01-05T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CryptoCraze - Google Sheets Price Update" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"johnlarkin1"},"dateModified":"2018-01-05T00:00:00-05:00","datePublished":"2018-01-05T00:00:00-05:00","description":"Text messages are fun… but an excel / Google Sheets spreadsheet is also great for organization.","headline":"CryptoCraze - Google Sheets Price Update","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2018/crypto-google-sheets-update/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/images/mountain.png"},"name":"johnlarkin1"},"url":"http://localhost:4000/2018/crypto-google-sheets-update/"}</script> <!-- End Jekyll SEO tag --><meta property="og:image" content="http://localhost:4000/assets/img/posts/cryptocurrency-meta_lg.jpg" /><meta property="og:image:type" content="image/jpeg" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:image" content="http://localhost:4000/assets/img/posts/cryptocurrency-meta_lg.jpg" /><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png?v=qA3OXqyw77" /><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png?v=qA3OXqyw77" /><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png?v=qA3OXqyw77" /><link rel="manifest" href="/assets/img/icons/manifest.json?v=qA3OXqyw77" /><link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg?v=qA3OXqyw77" color="#5bbad5" /> <!--[if IE ]><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77" /><![endif]--><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77" /><meta name="apple-mobile-web-app-title" content="Sleek" /><meta name="application-name" content="Sleek" /><meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml?v=qA3OXqyw77" /><meta name="theme-color" content="#ffffff" /> <!-- Google Tag Manager --> <script> (function (w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != "dataLayer" ? "&l=" + l : ""; j.async = true; j.src = "https://www.googletagmanager.com/gtm.js?id=GTM-KDHGNV6" + dl; f.parentNode.insertBefore(j, f); })(window, document, "script", "dataLayer", "GTM-KDHGNV6"); </script> <!-- End Google Tag Manager --><style class="inlineCSS"> h1{color:#313237;margin-top:0;margin-bottom:.5rem}.dark-bg{background-color:#313237}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:last-of-type,.post-card:nth-child(2n+2){margin-right:0}}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure,main{display:block}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}body{-webkit-overflow-scrolling:touch}*,::after,::before{-webkit-box-sizing:inherit;box-sizing:inherit}.site{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.site__content{-webkit-box-flex:1;-ms-flex:1;flex:1}img{max-width:100%;height:auto;width:auto;vertical-align:middle}figure{margin:0}body{background-color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Hiragino Sans GB","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;font-size:1rem;line-height:1.5;color:#343851;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%}p{margin-top:0;margin-bottom:1.25rem}h1,h2{color:#313237;margin-top:0;margin-bottom:.5rem}a{color:#277cea;text-decoration:none;border-bottom:1px dashed #277cea}.blur{background:#fff;filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur stdDeviation="16" /></filter></svg>#filter');-webkit-filter:blur(1rem);filter:blur(1rem)}.container{padding:0 20px;max-width:100%;margin:0 auto}@media only screen and (min-width:36em){.container{max-width:540px;margin:0 auto}}@media only screen and (min-width:48em){.container{max-width:720px;margin:0 auto}}@media only screen and (min-width:62em){.container{max-width:960px;margin:0 auto}}@media only screen and (min-width:75em){.container{max-width:1170px;margin:0 auto}}.header{background-color:#fff;color:#343851;position:absolute;z-index:4;width:100%;top:0;left:0;will-change:transform;-webkit-transform:translateY(0);transform:translateY(0)}.header a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:0}.header__logo{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;overflow:hidden;padding:19px 0;margin-right:1.25rem;outline:0;border-bottom:0;color:#313237}.header__logo .header__logo--container{width:58px}.header__logo .header__logo--container .logo{fill:currentColor}.header__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:3.75em;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header__links{padding-bottom:.5rem;display:none;position:absolute;top:3.75em;left:0;width:100%;height:auto;background:#fff}.header__link{color:#343851;padding:.938rem 0;border-top:1px solid #ededed}.header__toggle{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;height:100%;background-color:transparent;padding-left:1.25rem}.header__toggle span{display:block;position:relative;margin-top:4px;background-color:#343851;width:100%;height:2px;border-radius:1px}.header__toggle span:first-child{margin-top:0}@media (min-width:62em){.header__toggle{display:none;visibility:hidden}.header__links{position:static;padding:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;visibility:visible;width:auto;height:100%}.header__links-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;padding:0}.header__link{position:relative;padding:.938rem 1rem;border:0;height:100%}.header__link::after{content:"";display:block;position:absolute;left:0;bottom:0;height:3px;width:100%;-webkit-transform:scaleX(0);transform:scaleX(0);background:#277cea}}.post-card{display:block;position:relative;width:100%;min-height:250px;border-radius:4px;overflow:hidden;background-color:#fff;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.08);box-shadow:0 1px 3px rgba(0,0,0,.08);margin-bottom:2.25rem;border-bottom:0}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:0}}@media only screen and (min-width:75em){.post-card{width:31.25%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:3.125%}}.post-card__label{position:absolute;top:1.5rem;left:1.5rem;z-index:2}.post-card__inner{display:block;position:relative;padding:1.875rem 1.25rem .625rem;width:100%;color:#838c8d;border-bottom:0}.post-card__header{margin-bottom:.75rem}.post-card__meta{font-size:.875rem}.post-card__thumb{margin:0;background:#fff;position:relative;overflow:hidden}.post-card__thumb::after{content:"";display:block;height:0;width:100%;padding-bottom:56.25%}.post-card__thumb>*{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.label{padding:0 10px;margin-bottom:1rem;display:inline-block;line-height:20px;font-size:.75rem;text-transform:uppercase;letter-spacing:1px;color:rgba(255,255,255,.8);border:2px solid rgba(255,255,255,.5);border-radius:100px}.hero{margin:3.75rem auto 0;min-height:16.25rem;width:100%;position:relative;background-color:#dde5ea;background-repeat:no-repeat;background-position:50%;background-size:cover}@media only screen and (min-width:62em){.hero{margin:0 auto;height:36em}}.hero::before{position:absolute;display:block;content:"";top:0;left:0;width:100%;height:100%;background:rgba(52,56,81,.8)}.hero__wrap{position:absolute;margin:auto;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;color:rgba(255,255,255,.8);width:100%;max-width:90%;z-index:1}.hero__wrap .hero__title{font-size:1.8em;color:#fff}.blog{background-color:#f9f9f9}.post-list{padding-top:2.5em;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}@media only screen and (min-width:48em){.hero__wrap{max-width:40em}.hero__wrap .hero__title{padding:1rem 0;font-size:2.625em;line-height:3.125rem}.post-list{padding-top:5em}}</style><link rel="preload" href="/assets/css/main.css" as="style" onload="this.rel='stylesheet'" /> <noscript ><link rel="stylesheet" href="/assets/css/main.css" /></noscript> <script type="text/javascript"> /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */ (function(w){"use strict";if(!w.loadCSS){w.loadCSS=function(){}} var rp=loadCSS.relpreload={};rp.support=(function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=!1} return function(){return ret}})();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){link.media=finalMedia} if(link.addEventListener){link.addEventListener("load",enableStylesheet)}else if(link.attachEvent){link.attachEvent("onload",enableStylesheet)} setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3000)};rp.poly=function(){if(rp.support()){return} var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss",!0);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener){w.addEventListener("load",function(){rp.poly();w.clearInterval(run)})}else if(w.attachEvent){w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}} if(typeof exports!=="undefined"){exports.loadCSS=loadCSS} else{w.loadCSS=loadCSS}}(typeof global!=="undefined"?global:this)) </script></head><body class="site"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KDHGNV6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) --><header class="header" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation"><div class="container"><div class="header__inner"> <a class="header__logo" href="/"><div class="header__logo--container"> <?xml version="1.0" encoding="utf-8"?> <svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg" style="filter: invert(1);"> <g transform="matrix(0.1, 0, 0, -0.1, 15.002323, 500.303864)" fill="#000000" stroke="none"> <g transform="matrix(1, 0, 0, 1, 64.297943, -253.624268)"><path d="M 1148.351 4440.762 C 980.351 4426.762 838.351 4381.762 683.351 4293.762 C 579.351 4233.762 500.351 4171.762 405.351 4070.762 C 245.351 3903.762 123.351 3657.762 87.351 3430.762 C 71.351 3325.762 81.351 3069.762 107.351 2960.762 C 190.351 2598.762 441.351 2280.762 762.351 2129.762 C 916.351 2057.762 1064.351 2029.762 1277.351 2030.762 C 1446.351 2030.762 1595.351 2064.762 1756.351 2136.762 C 1909.351 2206.762 2089.351 2360.762 2263.351 2570.762 C 2306.351 2622.762 2447.351 2788.762 2577.351 2938.762 C 2707.351 3088.762 2846.351 3250.762 2886.351 3298.762 C 2986.351 3416.762 3084.351 3515.762 3138.351 3551.762 C 3329.351 3678.762 3580.351 3618.762 3689.351 3418.762 C 3722.351 3358.762 3723.351 3351.762 3723.351 3250.762 C 3723.351 3157.762 3720.351 3138.762 3696.351 3088.762 C 3661.351 3012.762 3589.351 2937.762 3519.351 2903.762 C 3469.351 2878.762 3452.351 2875.762 3363.351 2875.762 C 3293.351 2875.762 3247.351 2881.762 3211.351 2894.762 C 3145.351 2916.762 3031.351 2990.762 2953.351 3061.762 C 2838.351 3165.762 2854.351 3160.762 2809.351 3108.762 C 2787.351 3083.762 2748.351 3037.762 2722.351 3006.762 L 2676.351 2949.762 L 2699.351 2923.762 C 2842.351 2767.762 3041.351 2633.762 3178.351 2599.762 C 3209.351 2592.762 3286.351 2585.762 3353.351 2585.762 C 3491.351 2585.762 3577.351 2606.762 3688.351 2667.762 C 3785.351 2721.762 3893.351 2835.762 3946.351 2940.762 C 4003.351 3053.762 4021.351 3145.762 4015.351 3280.762 C 3998.351 3622.762 3740.351 3884.762 3398.351 3907.762 C 3197.351 3920.762 3000.351 3835.762 2837.351 3664.762 C 2779.351 3602.762 2482.351 3264.762 2383.351 3145.762 C 2351.351 3107.762 2321.351 3073.762 2318.351 3070.762 C 2315.351 3067.762 2246.351 2987.762 2164.351 2892.762 C 1904.351 2589.762 1814.351 2509.762 1643.351 2429.762 C 1401.351 2316.762 1106.351 2313.762 883.351 2422.762 C 847.351 2439.762 779.351 2483.762 731.351 2520.762 C 506.351 2690.762 384.351 2943.762 383.351 3235.762 C 383.351 3461.762 451.351 3655.762 589.351 3820.762 C 690.351 3942.762 856.351 4055.762 1008.351 4106.762 C 1086.351 4132.762 1393.351 4133.762 1486.351 4108.762 C 1593.351 4078.762 1696.351 4030.762 1803.351 3960.762 C 1927.351 3878.762 1938.351 3874.762 1983.351 3896.762 C 2030.351 3918.762 2106.351 4006.762 2114.351 4046.762 C 2125.351 4104.762 2105.351 4126.762 1963.351 4222.762 C 1782.351 4343.762 1629.351 4403.762 1418.351 4435.762 C 1315.351 4451.762 1292.351 4451.762 1148.351 4440.762 Z"/><path d="M 3158.351 4434.762 C 2991.351 4404.762 2823.351 4337.762 2689.351 4247.762 C 2568.351 4166.762 2426.351 4021.762 2173.351 3720.762 C 1901.351 3397.762 1583.351 3043.762 1507.351 2980.762 C 1409.351 2898.762 1335.351 2870.762 1217.351 2870.762 C 1059.351 2870.762 941.351 2944.762 877.351 3085.762 C 858.351 3126.762 854.351 3153.762 854.351 3235.762 C 853.351 3327.762 856.351 3341.762 885.351 3402.762 C 947.351 3534.762 1052.351 3606.762 1198.351 3617.762 C 1351.351 3629.762 1483.351 3563.762 1674.351 3378.762 L 1735.351 3319.762 L 1805.351 3392.762 C 1844.351 3432.762 1888.351 3479.762 1902.351 3497.762 L 1928.351 3528.762 L 1836.351 3615.762 C 1722.351 3722.762 1628.351 3790.762 1523.351 3841.762 C 1189.351 4003.762 788.351 3866.762 628.351 3535.762 C 501.351 3272.762 549.351 2979.762 753.351 2775.762 C 876.351 2651.762 999.351 2595.762 1173.351 2583.762 C 1332.351 2573.762 1502.351 2623.762 1629.351 2718.762 C 1713.351 2780.762 1925.351 3007.762 2248.351 3380.762 C 2330.351 3475.762 2469.351 3631.762 2524.351 3690.762 C 2547.351 3715.762 2594.351 3766.762 2629.351 3803.762 C 2710.351 3891.762 2820.351 3974.762 2933.351 4032.762 C 3077.351 4106.762 3140.351 4122.762 3310.351 4127.762 C 3446.351 4132.762 3462.351 4131.762 3549.351 4106.762 C 3832.351 4024.762 4059.351 3804.762 4157.351 3514.762 C 4215.351 3340.762 4211.351 3139.762 4145.351 2943.762 C 4100.351 2808.762 4035.351 2705.762 3924.351 2595.762 C 3734.351 2407.762 3523.351 2326.762 3265.351 2345.762 C 3055.351 2359.762 2913.351 2407.762 2739.351 2521.762 C 2631.351 2593.762 2600.351 2588.762 2514.351 2483.762 C 2483.351 2446.762 2468.351 2418.762 2468.351 2399.762 C 2468.351 2312.762 2744.351 2135.762 2972.351 2075.762 C 3111.351 2038.762 3113.351 2038.762 3275.351 2033.762 C 3603.351 2022.762 3851.351 2106.762 4084.351 2308.762 C 4329.351 2519.762 4483.351 2840.762 4505.351 3184.762 C 4511.351 3295.762 4500.351 3402.762 4466.351 3540.762 C 4371.351 3934.762 4066.351 4263.762 3676.351 4394.762 C 3523.351 4446.762 3312.351 4462.762 3158.351 4434.762 Z"/> </g> <g transform="matrix(1, 0, 0, 1, 23.988497, -200.499054)"><path d="M305 1726 c-15 -22 -11 -34 59 -222 41 -109 84 -230 97 -268 26 -75 52 -101 92 -91 29 8 35 19 98 187 24 65 46 118 49 118 3 0 29 -60 59 -133 29 -72 60 -142 67 -154 17 -28 55 -30 77 -5 22 24 207 513 207 547 0 39 -67 59 -104 32 -10 -8 -44 -89 -80 -195 l-62 -182 -54 132 c-60 143 -81 178 -110 178 -26 0 -39 -22 -100 -172 -29 -71 -54 -128 -55 -128 -2 0 -17 39 -34 88 -70 195 -103 273 -121 282 -32 17 -69 12 -85 -14z"/><path d="M1380 1730 c-19 -19 -20 -33 -20 -281 0 -150 4 -268 10 -279 13 -24 53 -33 84 -19 25 12 25 15 28 123 l3 111 138 3 137 3 0 -106 c0 -92 3 -108 20 -125 24 -24 48 -25 78 -4 22 15 22 17 22 289 0 272 0 274 -22 289 -30 21 -61 20 -81 -2 -14 -15 -17 -40 -17 -126 l0 -107 -137 3 -138 3 -2 108 c-1 92 -4 111 -20 122 -26 20 -60 18 -83 -5z"/><path d="M2235 1738 c-11 -6 -23 -16 -27 -22 -4 -6 -8 -128 -8 -272 0 -240 1 -262 18 -277 16 -15 46 -17 205 -17 185 0 187 0 202 24 16 25 12 49 -13 79 -13 15 -34 17 -154 17 l-138 0 0 48 c0 26 5 53 12 60 8 8 48 12 114 12 112 0 128 7 122 57 -4 40 -38 53 -145 53 l-93 0 0 60 0 60 130 0 c126 0 132 1 155 25 32 31 32 58 -1 84 -25 19 -40 21 -193 21 -105 0 -173 -5 -186 -12z"/><path d="M3759 1732 c-18 -12 -19 -31 -19 -281 0 -215 3 -271 14 -287 14 -18 26 -19 208 -16 133 3 195 7 200 15 4 7 8 26 8 44 0 54 -25 63 -177 63 l-133 0 0 54 c0 40 4 55 16 60 9 3 58 6 109 6 102 0 125 10 125 54 0 38 -20 45 -136 48 l-109 3 -3 34 c-2 19 -1 48 2 65 l6 31 136 2 c84 2 142 7 150 14 17 14 18 73 2 87 -21 16 -376 20 -399 4z"/><path d="M2953 1734 c-10 -4 -13 -72 -13 -289 0 -271 1 -285 19 -295 30 -16 59 -12 81 10 16 16 20 33 20 90 l0 70 48 0 47 -1 63 -84 62 -85 56 0 c38 0 56 4 60 14 3 8 -20 50 -50 94 -31 44 -56 83 -56 87 0 4 20 25 44 46 83 74 95 164 33 256 -52 76 -86 88 -257 90 -80 1 -151 0 -157 -3z m301 -143 c32 -30 34 -78 5 -115 -19 -25 -25 -26 -110 -26 l-89 0 0 86 0 86 84 -3 c73 -4 88 -7 110 -28z"/> </g> <g transform="matrix(1.18593, 0, 0, 1.18593, -376.416016, -436.098602)" style=""><path d="M 1802.803 958.916 C 1766.803 954.916 1718.803 905.916 1712.803 867.916 C 1705.803 821.916 1725.803 774.916 1763.803 749.916 C 1842.803 696.916 1944.803 748.916 1944.803 841.916 C 1944.803 922.916 1887.803 968.916 1802.803 958.916 Z M 1883.803 900.916 C 1938.803 830.916 1876.803 738.916 1798.803 771.916 C 1764.803 785.916 1754.803 802.916 1754.803 849.916 C 1754.803 919.916 1841.803 954.916 1883.803 900.916 Z"/><path d="M 2392.803 958.916 C 2356.803 954.916 2308.803 905.916 2302.803 867.916 C 2295.803 820.916 2315.803 774.916 2354.803 748.916 C 2383.803 728.916 2397.803 725.916 2438.803 730.916 C 2505.803 737.916 2516.803 749.916 2512.803 810.916 L 2509.803 861.916 L 2469.803 861.916 C 2439.803 861.916 2428.803 857.916 2426.803 844.916 C 2423.803 830.916 2429.803 826.916 2449.803 826.916 C 2472.803 826.916 2475.803 822.916 2472.803 799.916 C 2468.803 767.916 2434.803 754.916 2391.803 769.916 C 2358.803 780.916 2344.803 803.916 2344.803 849.916 C 2344.803 908.916 2409.803 945.916 2464.803 916.916 C 2486.803 904.916 2514.803 929.916 2493.803 941.916 C 2475.803 953.916 2421.803 962.916 2392.803 958.916 Z"/><path d="M 2642.803 958.916 C 2568.803 949.916 2527.803 846.916 2570.803 778.916 C 2628.803 688.916 2784.803 731.916 2784.803 838.916 C 2784.803 922.916 2729.803 969.916 2642.803 958.916 Z M 2723.803 900.916 C 2778.803 830.916 2716.803 738.916 2638.803 771.916 C 2604.803 785.916 2594.803 802.916 2594.803 849.916 C 2594.803 919.916 2681.803 954.916 2723.803 900.916 Z"/><path d="M 3806.803 950.916 C 3785.803 942.916 3774.803 930.916 3774.803 916.916 C 3774.803 892.916 3791.803 890.916 3815.803 912.916 C 3836.803 931.916 3864.803 924.916 3864.803 900.916 C 3864.803 891.916 3853.803 870.916 3839.803 854.916 C 3825.803 837.916 3815.803 818.916 3817.803 812.916 C 3822.803 797.916 3854.803 792.916 3854.803 806.916 C 3854.803 813.916 3865.803 831.916 3879.803 848.916 C 3918.803 894.916 3911.803 936.916 3863.803 954.916 C 3846.803 961.916 3829.803 960.916 3806.803 950.916 Z"/><path d="M 675.803 939.916 C 675.803 929.916 687.803 881.916 702.803 831.916 C 724.803 759.916 733.803 740.916 750.803 738.916 C 767.803 736.916 773.803 746.916 793.803 816.916 C 806.803 860.916 819.803 894.916 823.803 891.916 C 826.803 887.916 838.803 852.916 850.803 813.916 C 867.803 756.916 875.803 740.916 892.803 738.916 C 910.803 735.916 916.803 745.916 934.803 808.916 C 946.803 848.916 959.803 894.916 965.803 910.916 C 978.803 950.916 977.803 956.916 955.803 956.916 C 940.803 956.916 933.803 942.916 919.803 886.916 C 910.803 847.916 898.803 814.916 894.803 811.916 C 890.803 809.916 877.803 840.916 864.803 882.916 C 845.803 946.916 839.803 957.916 822.803 954.916 C 806.803 952.916 797.803 935.916 782.803 886.916 C 771.803 850.916 759.803 817.916 755.803 813.916 C 750.803 809.916 739.803 838.916 728.803 878.916 C 714.803 930.916 704.803 952.916 692.803 954.916 C 680.803 956.916 674.803 951.916 675.803 939.916 Z"/><path d="M 1004.803 846.916 C 1004.803 755.916 1007.803 736.916 1019.803 736.916 C 1031.803 736.916 1034.803 755.916 1034.803 846.916 C 1034.803 937.916 1031.803 956.916 1019.803 956.916 C 1007.803 956.916 1004.803 937.916 1004.803 846.916 Z"/><path d="M 1094.803 847.916 L 1094.803 736.916 L 1159.803 736.916 C 1210.803 736.916 1224.803 739.916 1224.803 751.916 C 1224.803 762.916 1212.803 766.916 1179.803 766.916 L 1135.803 766.916 L 1132.803 858.916 C 1129.803 937.916 1126.803 951.916 1112.803 954.916 C 1096.803 957.916 1094.803 947.916 1094.803 847.916 Z"/><path d="M 1254.803 846.916 L 1254.803 736.916 L 1324.803 736.916 C 1380.803 736.916 1394.803 739.916 1394.803 751.916 C 1394.803 762.916 1382.803 766.916 1344.803 766.916 L 1294.803 766.916 L 1294.803 861.916 C 1294.803 949.916 1293.803 956.916 1274.803 956.916 C 1255.803 956.916 1254.803 949.916 1254.803 846.916 Z"/><path d="M 1494.803 951.916 C 1494.803 949.916 1512.803 919.916 1534.803 885.916 C 1565.803 837.916 1574.803 813.916 1574.803 779.916 C 1574.803 743.916 1577.803 736.916 1594.803 736.916 C 1611.803 736.916 1614.803 743.916 1614.803 786.916 C 1614.803 827.916 1621.803 846.916 1649.803 889.916 C 1689.803 949.916 1691.803 956.916 1665.803 956.916 C 1652.803 956.916 1637.803 941.916 1623.803 916.916 C 1610.803 894.916 1597.803 876.916 1593.803 876.916 C 1590.803 876.916 1575.803 894.916 1560.803 916.916 C 1544.803 940.916 1526.803 956.916 1514.803 956.916 C 1503.803 956.916 1494.803 954.916 1494.803 951.916 Z"/><path d="M 1986.803 867.916 C 1988.803 798.916 1993.803 774.916 2008.803 758.916 C 2047.803 714.916 2130.803 722.916 2153.803 772.916 C 2159.803 786.916 2164.803 833.916 2164.803 876.916 C 2164.803 949.916 2162.803 956.916 2144.803 956.916 C 2126.803 956.916 2124.803 949.916 2124.803 873.916 C 2124.803 782.916 2116.803 766.916 2072.803 766.916 C 2034.803 766.916 2024.803 790.916 2024.803 880.916 C 2024.803 951.916 2022.803 956.916 2003.803 956.916 C 1983.803 956.916 1982.803 952.916 1986.803 867.916 Z"/><path d="M 2924.803 846.916 C 2924.803 743.916 2925.803 736.916 2944.803 736.916 C 2962.803 736.916 2964.803 743.916 2964.803 819.916 L 2965.803 901.916 L 3017.803 819.916 C 3061.803 748.916 3073.803 736.916 3097.803 736.916 L 3124.803 736.916 L 3124.803 846.916 C 3124.803 949.916 3123.803 956.916 3104.803 956.916 C 3087.803 956.916 3085.803 948.916 3082.803 874.916 L 3079.803 791.916 L 3027.803 874.916 C 2984.803 941.916 2970.803 956.916 2949.803 956.916 L 2924.803 956.916 L 2924.803 846.916 Z"/><path d="M 3174.803 846.916 L 3174.803 736.916 L 3255.803 736.916 C 3315.803 736.916 3335.803 739.916 3332.803 749.916 C 3329.803 756.916 3305.803 762.916 3271.803 764.916 C 3215.803 767.916 3214.803 768.916 3214.803 796.916 C 3214.803 825.916 3215.803 826.916 3264.803 826.916 C 3307.803 826.916 3314.803 829.916 3314.803 846.916 C 3314.803 863.916 3307.803 866.916 3264.803 866.916 C 3215.803 866.916 3214.803 867.916 3214.803 896.916 C 3214.803 926.916 3215.803 926.916 3269.803 926.916 C 3311.803 926.916 3324.803 929.916 3324.803 941.916 C 3324.803 953.916 3309.803 956.916 3249.803 956.916 L 3174.803 956.916 L 3174.803 846.916 Z"/><path d="M 3390.803 902.916 L 3426.803 847.916 L 3397.803 804.916 C 3351.803 737.916 3351.803 736.916 3374.803 736.916 C 3387.803 736.916 3404.803 751.916 3424.803 782.916 L 3453.803 828.916 L 3481.803 782.916 C 3501.803 749.916 3515.803 736.916 3532.803 736.916 C 3557.803 736.916 3557.803 736.916 3512.803 803.916 C 3497.803 826.916 3484.803 847.916 3484.803 850.916 C 3484.803 854.916 3498.803 875.916 3514.803 898.916 C 3549.803 946.916 3551.803 956.916 3524.803 956.916 C 3512.803 956.916 3496.803 941.916 3482.803 916.916 C 3469.803 894.916 3457.803 876.916 3454.803 876.916 C 3451.803 876.916 3439.803 894.916 3426.803 916.916 C 3409.803 946.916 3397.803 956.916 3379.803 956.916 L 3354.803 956.916 L 3390.803 902.916 Z"/><path d="M 3564.803 941.916 C 3564.803 931.916 3575.803 926.916 3599.803 926.916 L 3634.803 926.916 L 3634.803 831.916 C 3634.803 743.916 3636.803 736.916 3654.803 736.916 C 3672.803 736.916 3674.803 744.916 3676.803 829.916 L 3679.803 921.916 L 3712.803 924.916 C 3732.803 926.916 3744.803 933.916 3744.803 942.916 C 3744.803 953.916 3726.803 956.916 3654.803 956.916 C 3581.803 956.916 3564.803 953.916 3564.803 941.916 Z"/><path d="M 3821.803 769.916 C 3807.803 756.916 3815.803 736.916 3834.803 736.916 C 3847.803 736.916 3854.803 743.916 3854.803 756.916 C 3854.803 775.916 3834.803 783.916 3821.803 769.916 Z"/> </g> </g> </svg></div></a><nav class="header__links"><div class="container header__links-wrapper"> <a class="header__link" href="/" itemprop="url"> <span itemprop="name">Home</span> </a> <a class="header__link" href="/about" itemprop="url"> <span itemprop="name">About</span> </a> <a class="header__link" href="/categories" itemprop="url"> <span itemprop="name">Categories</span> </a> <a class="header__link" href="/contact" itemprop="url"> <span itemprop="name">Contact</span> </a></div></nav><div class="header__toggle"> <span></span> <span></span> <span></span></div></div></div></header><div class="hero lazyload" data-bg="http://localhost:4000/assets/img/posts/cryptocurrency-meta.jpg"><div class="hero__wrap"><div class="hero__categories"> <a class="label" href="/categories/#Crypto">Crypto</a> &nbsp; <a class="label" href="/categories/#Dev">Dev</a></div><h1 class="hero__title">CryptoCraze - Google Sheets Price Update</h1><p class="hero__meta"> <span> <time>05 Jan 2018</time>&nbsp;&middot; </span> <span> 13 mins read </span></p></div></div><main class="site__content"><div class="container"><article class="post-content" itemprop="articleBody"><p>Text messages are fun… but an excel / Google Sheets spreadsheet is also great for organization.</p><p>The roomie (<a href="https://www.linkedin.com/in/joseph-willcox-will-jaroszewicz-27313466">Will J</a>) and I were curious about an organized way to automatically update current crypto metrics for an excel spreadsheet. We’ve got a couple of buddies who are trading and Will - being the bright Harvard stud that he is - pitched this idea to me saying that it would really help some of his friends out.</p><p>So I set out to create another cronjob that would run regularly to pull markets from once again, the CoinMarketCap API and disseminate the prices as we like. If you just want the code and you want to decipher what’s going on solely from that, <a href="https://github.com/johnlarkin1/crypto-sheets-update">here it is</a> and knock yourself out.</p><h1 id="main-idea">Main Idea</h1><p>The spreadsheet was going to have one column that lists the symbols of the cryptos that my friends are actively involved in. So the program should be able to read that column and parse all of the appropriate symbols and then make the corresponding call to <code class="language-plaintext highlighter-rouge">coinmarketcap</code> to search for the information that my buddies wanted to be displayed on a close-to-real-time level. So let’s break this up into parts for clearer understanding. Here’s a link to the generated html page.</p><h1 id="initial-setup">Initial Setup</h1><p>Now, I’m not going to go into using the <code class="language-plaintext highlighter-rouge">coinmarketcap</code> python package - firstly, because it’s simple to use and secondly, because I already did in this <a href="https://johnlarkin1.github.io/2017/12/12/crypto-notifications.html">blog post</a>. I suggest you check out that one if you want to kind of understand the API and what’s going on.</p><p>However, the new piece of the puzzle that I was expanding on was connecting to Google Sheets, which has a great API. I wrote this program in python so the following was primarily the specific tutorial that I used to get started. You can find it <a href="https://developers.google.com/sheets/api/quickstart/python">here</a>.</p><p>Again, I’m not going to go into the exact details on setting up connection for the API, but I will say that I do think it’s fundamental for you to be able to get the <code class="language-plaintext highlighter-rouge">quickstart.py</code> program that Google provides. Again, see step #3 <a href="https://developers.google.com/sheets/api/quickstart/python">here</a>.</p><p>Once everything is good there and you’re able to successfully print out the names and majors of a dummy open spreadsheet that Google provides, then the world is yours and you can really get cracking. Writing to sheets is just another method call to the service. There’s a couple of things of importance that are to highlight.</p><p>However, we do need a little bit of specific information about the spreadsheet that you’re trying to work with. Google in their quickstart program uses a <a href="https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit">dummy excel spreadsheet</a>. You can find the actual program <a href="https://developers.google.com/sheets/api/quickstart/python">here</a>. A couple things about the terminology that the API tutorial uses can be found <a href="https://developers.google.com/sheets/api/guides/concepts">here</a>. But I’ll cover them quickly below. Let’s look at the url of the dummy sheet.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit#gid=0
</code></pre></div></div><p>This can be broken into a couple of main parts</p><p>The <code class="language-plaintext highlighter-rouge">id</code> portion of this spreadsheet is everything between the <code class="language-plaintext highlighter-rouge">d/</code> and the <code class="language-plaintext highlighter-rouge">/edit</code> bit. That means this spreadsheet id is</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms
</code></pre></div></div><p>The <code class="language-plaintext highlighter-rouge">sheetId</code> portion of the spreadsheet is what comes after the <code class="language-plaintext highlighter-rouge">edit#gid=</code> bit. So this has a sheetId of</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
</code></pre></div></div><p>Those are really the two important things you’ll need.</p><p>So the way I arranged the program was to pull from a yaml. The yaml file looks like</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spreadsheet_id: &lt;insert yours here&gt;
sheet_id: &lt;insert yours here&gt;
update_time_range_name: &lt;insert yours here&gt;
to_write_range_name: &lt;insert yours here&gt;
crypto_ticker_range_name: &lt;insert yours here&gt;
value_input_option: &lt;either RAW or USER_ENTERED&gt;
</code></pre></div></div><p>I pushed up a dummy one with the commit as well. Also note, that Google designed the program to work that for the first time you actually log into the spreadsheet it will create a <code class="language-plaintext highlighter-rouge">client_secret.json</code> file and populate it with various params needed for the connection. After you log in once, you should be good to go.</p><p>For my yaml dictionary, we already talked about the ids. The range name is specified in A1 notation. There’s three ranges total. One range to specify the time you updated the spreadsheet (a helpful indication of if it was successfully done by your cronjob). One range is to pull the crypto symbols to specify what you care about. Then a final range so that you’re able to write all of the information you want into that reason. Anyway, let’s expand a bit further.</p><h1 id="reading-the-data">Reading the Data</h1><p>The actual code that reqads the data and parses the tickert is as simple as this.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="n">service</span><span class="p">.</span><span class="n">spreadsheets</span><span class="p">().</span><span class="n">values</span><span class="p">().</span><span class="n">get</span><span class="p">(</span>
    <span class="n">spreadsheetId</span><span class="o">=</span><span class="n">spreadsheet_id</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">crypto_symbol_range_name</span><span class="p">).</span><span class="n">execute</span><span class="p">()</span>
<span class="c1"># Saying if values doesn't exist, return [] as default value. Values is a list of lists.
# List per every row.
</span><span class="n">read_values</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'values'</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">flat_list_of_symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">read_values</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
</code></pre></div></div><p>Note a couple of things. We had to flatten the list of lists to make the pertinent data more easily readable. This is because you get a list per every row that is read.</p><p>Secondly, the call to read is really simple. It’s really just paying close attention to the format that everything is in so that the reading and writing is done cleanly.</p><h1 id="writing-the-data">Writing the Data</h1><p>This was a bit more of the fun part. So from above, we have our flat_list_of_symbols. So this is going to be like:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Flat list of symbols: [u'BTC', u'ETH', u'MIOTA', u'XRP]
</code></pre></div></div><p>So that’s bitcoin, ethereum, iota, and ripple for example. A random example of what one might be interested in.</p><p>We’ve got this list and we want to get let’s say the prices, the marketcap, and percent change for the past 24 hours since the time of the query. Luckily for us, this information is all provided by the CoinMarketCap API.</p><p>We run into an issue here. Mainly, the size of the data that we care about. We don’t want to truncate the amount of market data that we’ve actually grabbed because who knows - maybe my lunatic friends are betting big on some small crypto that just barely crept into the top 100 in terms of market cap. But at the same time, we don’t want to have to iterate over this entire 100 length list of dictionaries to find the crypto information that we care about. The final thing is that order does matter here. We received the crypto symbols in an order from top to bottom in terms of the column. We want to write the correct price, market cap, and percent change that corresponds with the right crypto. So we need to ensure that we’re at least iterating over the flattened list of symbols in order.</p><p>So that’s fine, but then I didn’t think it would be optimal to have a double for loop with the inner loop iterating once every 100 times. This means the big O of this specific step would be \(O(100 * n)\) where \(n\) is the number of cryptos that my buddies are invested in. <em>Technically</em>, that’s still linear because the size of the inner loop is fixed, but we’re not dealing with theory of comp here. We’re dealing with actual time. So I figured it’d be a lot better to filter our list of dictionaries to only contain relevant cryptos. Again, now it’s <em>theoretically</em> \(O(n^2)\) but *in reality* (which is what we live in) this is going to be optimized to the first approach. One other step that we can take to optimize the runtime of the loop is to break as soon as we find the right values to append. The other thing we need to be cautious of is - ok well what’s the runtime of the filter operation? I’m guessing linear, but it’s also written in C or C++ backend, so I’ll take that essentially anyday.</p><p>Anyway, the final result for grabbing the crypto price, market cap, and percent change for the past 24 hours is just these clean pythonic couple of lines.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">filt_crypto_market_info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s">'symbol'</span><span class="p">]</span> <span class="ow">in</span> <span class="n">flat_list_of_symbols</span><span class="p">,</span> <span class="n">crypto_market_info</span><span class="p">))</span>
<span class="k">for</span> <span class="n">crypto_symbol</span> <span class="ow">in</span> <span class="n">list_of_symbols</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">crypto_info</span> <span class="ow">in</span> <span class="n">crypto_market_info</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">crypto_symbol</span> <span class="o">==</span> <span class="n">crypto_info</span><span class="p">[</span><span class="s">'symbol'</span><span class="p">]:</span>
            <span class="n">values_to_write</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">crypto_info</span><span class="p">[</span><span class="s">'price_usd'</span><span class="p">],</span> <span class="n">crypto_info</span><span class="p">[</span><span class="s">'market_cap_usd'</span><span class="p">],</span> <span class="n">crypto_info</span><span class="p">[</span><span class="s">'percent_change_24h'</span><span class="p">]</span> <span class="o">+</span> <span class="s">'%'</span><span class="p">])</span> <span class="c1"># need to add % for excel
</span>            <span class="k">break</span>
</code></pre></div></div><h1 id="formatting-the-data-correctly">Formatting the Data Correctly</h1><p>Again, another slightly tricky part of this program was the fluctuation between the google sheets API call. If you’re doing multiple updates per one batch call you need to format the data differently than say if you were to only update one range of cells. Otherwise, the google sheets API will complain about it. Specifically, for the way I’m doing it, we need to store the data we want to write as a value in a dictionary that we pass to the API call. The type of the data is a list of dictionaries that correspond to the values to write for each block. So it’s decently nested which can make debugging slightly tricky.</p><p>The writing portion is pretty much handled my the API call which makes this really nice and clean. So I’m not going to cover anything about that.</p><h1 id="emailing-the-spreadsheet-after-update">Emailing the Spreadsheet After Update</h1><p>Also because I figured that it was too much for my friends to actually check the spreadsheet on a mobile device or like text me and ask if I’ve updated it yet, I set up a cronjob and also wrote a google sheets function which was a first for me.</p><p>What you can do is go to <code class="language-plaintext highlighter-rouge">Tools &gt; Script editor... &gt; Create new project</code> and then pretty much just go to town. You can also automate when this new project is called, so I just did twice a day. The google scripting language is very similar to javascript, which I have a very limited proficiency in but I was able to get the job done here.</p><p>Here’s the code that builds the email and sends a saved pdf that has all the information of the spreadsheet. Rather than generated text, the pdf actually preserves format and highlighting (and it’s already there) so I figured I’d use that.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">createAndSendPDF</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSheet</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">spreadsheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">documentProperties</span> <span class="o">=</span> <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getDocumentProperties</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">users</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">getEditors</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">emailBuilder</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>

  <span class="c1">// Build up the emails</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">users</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">emailBuilder</span> <span class="o">=</span> <span class="nx">emailBuilder</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">users</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getEmail</span><span class="p">());</span>
    <span class="kd">var</span> <span class="nx">emailBuilder</span> <span class="o">=</span> <span class="nx">emailBuilder</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Trim off excess comma</span>
  <span class="kd">var</span> <span class="nx">emailBuilder</span> <span class="o">=</span> <span class="nx">emailBuilder</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">emailBuilder</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

  <span class="c1">// This is going to be the message in the email</span>
  <span class="kd">var</span> <span class="nx">messageInEmail</span> <span class="o">=</span>
    <span class="dl">"</span><span class="s2">Please see the attached for your daily crypto report #hodl</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">subjectOfEmail</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Daily CryptoCM Update</span><span class="dl">"</span><span class="p">;</span>

  <span class="c1">// Generate pdf</span>
  <span class="kd">var</span> <span class="nx">pdf</span> <span class="o">=</span> <span class="nx">DriveApp</span><span class="p">.</span><span class="nx">getFileById</span><span class="p">(</span><span class="nx">spreadsheet</span><span class="p">.</span><span class="nx">getId</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">getAs</span><span class="p">(</span><span class="dl">"</span><span class="s2">application/pdf</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">getBytes</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">attach</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">fileName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Daily CryptoCM Report.pdf</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">content</span><span class="p">:</span> <span class="nx">pdf</span><span class="p">,</span>
    <span class="na">mimeType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/pdf</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">};</span>

  <span class="c1">// Send the freshly constructed email</span>
  <span class="nx">MailApp</span><span class="p">.</span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">emailBuilder</span><span class="p">,</span> <span class="nx">subjectOfEmail</span><span class="p">,</span> <span class="nx">messageInEmail</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">attachments</span><span class="p">:</span> <span class="p">[</span><span class="nx">attach</span><span class="p">],</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div><h1 id="generating-documentation">Generating Documentation</h1><p>One other thing that I dipped my toes into with this project is pydoc and the ability to use pydoc style comments to generate a helpful html page just explaining the script and some of the function calls. Really, all you need to do is have:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pydoc -w &lt;name_of_python_file_without_extension&gt;
</code></pre></div></div><p>and the html file will get created automatically. Also, it’s important to note that you need to design your comments in a certain way in order for the parser to pick them up when the html doc is being created. I can’t really link it but if you pull it down from Github you can see what it would actually look like in a browser.</p><h1 id="finalizing-the-product">Finalizing the Product</h1><p>A good confirmation check is just running the script and making sure the updated time in your spreadsheet is recent and that all of the crypto metrics look correct. Another good check program side would be ensuring that the number of updated cells that is logged is what you want.</p><p>After that you’re good to go with setting up that cronjob to regularly pull in these prices if your friends want to be up to date with their returns and losses and current status of their portfolio. I’m not going to go into that detail with this post, but you can check out my other post <a href="https://johnlarkin1.github.io/2017/12/12/crypto-notifications.html">here</a>.</p><p>My typical comments at the end. Let me know if you think I can improve my code algorithmically, design-wise, better comments or whatever. I always appreciate the feedback. Thanks for reading as always. <a href="https://github.com/johnlarkin1/crypto-sheets-update">Here’s the code</a> if you didn’t already peek it!</p></article><div class="post-content controls__inner"><div class="controls__item prev"> <span>Previous</span> <a href="/2017/crypto-notifications/"> <span> <svg xmlns="http://www.w3.org/2000/svg" width="6" height="11"><path fill="fillColor" d="M5.647 1.718c.37-.434.323-1.09-.106-1.465A1.016 1.016 0 0 0 4.095.36L.25 4.875a1.05 1.05 0 0 0 .017 1.378l3.95 4.407c.38.424 1.03.456 1.448.07a1.05 1.05 0 0 0 .07-1.468l-3.34-3.725 3.253-3.819z"/> </svg> </span> CryptoCraze - Text Notifica... </a></div><div class="controls__item next"> <span>Next</span> <a href="/2018/ror-intro/"> Ruby on Rails Introduction ... <span> <svg xmlns="http://www.w3.org/2000/svg" width="6" height="11"><path fill="#fillColor" d="M.353 9.282c-.37.434-.323 1.09.106 1.465a1.016 1.016 0 0 0 1.446-.107L5.75 6.125a1.05 1.05 0 0 0-.017-1.378L1.784.34A1.015 1.015 0 0 0 .336.27a1.05 1.05 0 0 0-.07 1.468l3.34 3.725L.353 9.282z"/> </svg> </span> </a></div></div></div></main><footer class="footer"><div class="container"><nav class="social"> <a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/johnlarkin1"> <svg class="social__icon" viewBox="0 0 50 50" width="24px" height="24px" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M17.791,46.836C18.502,46.53,19,45.823,19,45v-5.4c0-0.197,0.016-0.402,0.041-0.61C19.027,38.994,19.014,38.997,19,39c0,0-3,0-3.6,0c-1.5,0-2.8-0.6-3.4-1.8c-0.7-1.3-1-3.5-2.8-4.7C8.9,32.3,9.1,32,9.7,32c0.6,0.1,1.9,0.9,2.7,2c0.9,1.1,1.8,2,3.4,2c2.487,0,3.82-0.125,4.622-0.555C21.356,34.056,22.649,33,24,33v-0.025c-5.668-0.182-9.289-2.066-10.975-4.975c-3.665,0.042-6.856,0.405-8.677,0.707c-0.058-0.327-0.108-0.656-0.151-0.987c1.797-0.296,4.843-0.647,8.345-0.714c-0.112-0.276-0.209-0.559-0.291-0.849c-3.511-0.178-6.541-0.039-8.187,0.097c-0.02-0.332-0.047-0.663-0.051-0.999c1.649-0.135,4.597-0.27,8.018-0.111c-0.079-0.5-0.13-1.011-0.13-1.543c0-1.7,0.6-3.5,1.7-5c-0.5-1.7-1.2-5.3,0.2-6.6c2.7,0,4.6,1.3,5.5,2.1C21,13.4,22.9,13,25,13s4,0.4,5.6,1.1c0.9-0.8,2.8-2.1,5.5-2.1c1.5,1.4,0.7,5,0.2,6.6c1.1,1.5,1.7,3.2,1.6,5c0,0.484-0.045,0.951-0.11,1.409c3.499-0.172,6.527-0.034,8.204,0.102c-0.002,0.337-0.033,0.666-0.051,0.999c-1.671-0.138-4.775-0.28-8.359-0.089c-0.089,0.336-0.197,0.663-0.325,0.98c3.546,0.046,6.665,0.389,8.548,0.689c-0.043,0.332-0.093,0.661-0.151,0.987c-1.912-0.306-5.171-0.664-8.879-0.682C35.112,30.873,31.557,32.75,26,32.969V33c2.6,0,5,3.9,5,6.6V45c0,0.823,0.498,1.53,1.209,1.836C41.37,43.804,48,35.164,48,25C48,12.318,37.683,2,25,2S2,12.318,2,25C2,35.164,8.63,43.804,17.791,46.836z"/> </svg> </a> <a class="social__link" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/johnlarkin1"> <svg class="social__icon" viewBox="0 0 50 50" width="24px" height="24px" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M41,4H9C6.24,4,4,6.24,4,9v32c0,2.76,2.24,5,5,5h32c2.76,0,5-2.24,5-5V9C46,6.24,43.76,4,41,4z M17,20v19h-6V20H17z M11,14.47c0-1.4,1.2-2.47,3-2.47s2.93,1.07,3,2.47c0,1.4-1.12,2.53-3,2.53C12.2,17,11,15.87,11,14.47z M39,39h-6c0,0,0-9.26,0-10c0-2-1-4-3.5-4.04h-0.08C27,24.96,26,27.02,26,29c0,0.91,0,10,0,10h-6V20h6v2.56c0,0,1.93-2.56,5.81-2.56c3.97,0,7.19,2.73,7.19,8.26V39z"/> </svg> </a></nav><span>&copy; 2025 Where will you go next?. All rights reserved.</span></div></footer><script async src="/assets/js/bundle.js"></script></body></html>
