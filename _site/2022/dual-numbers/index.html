<!DOCTYPE html><html lang="en-US"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta property="og:image" content="http://localhost:4000/assets/img/posts/dual-numbers.jpg"> <!-- Begin Jekyll SEO tag v2.8.0 --><title>Dual Numbers and Automatic Differentiation | Where will you go next?</title><meta name="generator" content="Jekyll v3.9.2" /><meta property="og:title" content="Dual Numbers and Automatic Differentiation" /><meta name="author" content="johnlarkin1" /><meta property="og:locale" content="en_US" /><meta name="description" content="An homage to Matt and Swarthmore." /><meta property="og:description" content="An homage to Matt and Swarthmore." /><link rel="canonical" href="http://localhost:4000/2022/dual-numbers/" /><meta property="og:url" content="http://localhost:4000/2022/dual-numbers/" /><meta property="og:site_name" content="Where will you go next?" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-17T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Dual Numbers and Automatic Differentiation" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"johnlarkin1"},"dateModified":"2022-01-17T00:00:00-05:00","datePublished":"2022-01-17T00:00:00-05:00","description":"An homage to Matt and Swarthmore.","headline":"Dual Numbers and Automatic Differentiation","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2022/dual-numbers/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/images/mountain.png"},"name":"johnlarkin1"},"url":"http://localhost:4000/2022/dual-numbers/"}</script> <!-- End Jekyll SEO tag --><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png?v=qA3OXqyw77"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png?v=qA3OXqyw77"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png?v=qA3OXqyw77"><link rel="manifest" href="/assets/img/icons/manifest.json?v=qA3OXqyw77"><link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg?v=qA3OXqyw77" color="#5bbad5"> <!--[if IE]><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><![endif]--><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><meta name="apple-mobile-web-app-title" content="Sleek"><meta name="application-name" content="Sleek"><meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml?v=qA3OXqyw77"><meta name="theme-color" content="#ffffff"> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=GTM-KDHGNV6"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'GTM-KDHGNV6'); </script><style class="inlineCSS"> h1{color:#313237;margin-top:0;margin-bottom:.5rem}.dark-bg{background-color:#313237}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:last-of-type,.post-card:nth-child(2n+2){margin-right:0}}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure,main{display:block}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}body{-webkit-overflow-scrolling:touch}*,::after,::before{-webkit-box-sizing:inherit;box-sizing:inherit}.site{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.site__content{-webkit-box-flex:1;-ms-flex:1;flex:1}img{max-width:100%;height:auto;width:auto;vertical-align:middle}figure{margin:0}body{background-color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Hiragino Sans GB","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;font-size:1rem;line-height:1.5;color:#343851;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%}p{margin-top:0;margin-bottom:1.25rem}h1,h2{color:#313237;margin-top:0;margin-bottom:.5rem}a{color:#277cea;text-decoration:none;border-bottom:1px dashed #277cea}.blur{background:#fff;filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur stdDeviation="16" /></filter></svg>#filter');-webkit-filter:blur(1rem);filter:blur(1rem)}.container{padding:0 20px;max-width:100%;margin:0 auto}@media only screen and (min-width:36em){.container{max-width:540px;margin:0 auto}}@media only screen and (min-width:48em){.container{max-width:720px;margin:0 auto}}@media only screen and (min-width:62em){.container{max-width:960px;margin:0 auto}}@media only screen and (min-width:75em){.container{max-width:1170px;margin:0 auto}}.header{background-color:#fff;color:#343851;position:absolute;z-index:4;width:100%;top:0;left:0;will-change:transform;-webkit-transform:translateY(0);transform:translateY(0)}.header a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:0}.header__logo{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;overflow:hidden;padding:19px 0;margin-right:1.25rem;outline:0;border-bottom:0;color:#313237}.header__logo .header__logo--container{width:58px}.header__logo .header__logo--container .logo{fill:currentColor}.header__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:3.75em;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header__links{padding-bottom:.5rem;display:none;position:absolute;top:3.75em;left:0;width:100%;height:auto;background:#fff}.header__link{color:#343851;padding:.938rem 0;border-top:1px solid #ededed}.header__toggle{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;height:100%;background-color:transparent;padding-left:1.25rem}.header__toggle span{display:block;position:relative;margin-top:4px;background-color:#343851;width:100%;height:2px;border-radius:1px}.header__toggle span:first-child{margin-top:0}@media (min-width:62em){.header__toggle{display:none;visibility:hidden}.header__links{position:static;padding:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;visibility:visible;width:auto;height:100%}.header__links-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;padding:0}.header__link{position:relative;padding:.938rem 1rem;border:0;height:100%}.header__link::after{content:"";display:block;position:absolute;left:0;bottom:0;height:3px;width:100%;-webkit-transform:scaleX(0);transform:scaleX(0);background:#277cea}}.post-card{display:block;position:relative;width:100%;min-height:250px;border-radius:4px;overflow:hidden;background-color:#fff;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.08);box-shadow:0 1px 3px rgba(0,0,0,.08);margin-bottom:2.25rem;border-bottom:0}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:0}}@media only screen and (min-width:75em){.post-card{width:31.25%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:3.125%}}.post-card__label{position:absolute;top:1.5rem;left:1.5rem;z-index:2}.post-card__inner{display:block;position:relative;padding:1.875rem 1.25rem .625rem;width:100%;color:#838c8d;border-bottom:0}.post-card__header{margin-bottom:.75rem}.post-card__meta{font-size:.875rem}.post-card__thumb{margin:0;background:#fff;position:relative;overflow:hidden}.post-card__thumb::after{content:"";display:block;height:0;width:100%;padding-bottom:56.25%}.post-card__thumb>*{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.label{padding:0 10px;margin-bottom:1rem;display:inline-block;line-height:20px;font-size:.75rem;text-transform:uppercase;letter-spacing:1px;color:rgba(255,255,255,.8);border:2px solid rgba(255,255,255,.5);border-radius:100px}.hero{margin:3.75rem auto 0;min-height:16.25rem;width:100%;position:relative;background-color:#dde5ea;background-repeat:no-repeat;background-position:50%;background-size:cover}@media only screen and (min-width:62em){.hero{margin:0 auto;height:36em}}.hero::before{position:absolute;display:block;content:"";top:0;left:0;width:100%;height:100%;background:rgba(52,56,81,.8)}.hero__wrap{position:absolute;margin:auto;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;color:rgba(255,255,255,.8);width:100%;max-width:90%;z-index:1}.hero__wrap .hero__title{font-size:1.8em;color:#fff}.blog{background-color:#f9f9f9}.post-list{padding-top:2.5em;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}@media only screen and (min-width:48em){.hero__wrap{max-width:40em}.hero__wrap .hero__title{padding:1rem 0;font-size:2.625em;line-height:3.125rem}.post-list{padding-top:5em}}</style><link rel="preload" href="/assets/css/main.css" as="style" onload="this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="/assets/css/main.css"></noscript> <script type="text/javascript"> /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */ (function(w){"use strict";if(!w.loadCSS){w.loadCSS=function(){}} var rp=loadCSS.relpreload={};rp.support=(function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=!1} return function(){return ret}})();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){link.media=finalMedia} if(link.addEventListener){link.addEventListener("load",enableStylesheet)}else if(link.attachEvent){link.attachEvent("onload",enableStylesheet)} setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3000)};rp.poly=function(){if(rp.support()){return} var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss",!0);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener){w.addEventListener("load",function(){rp.poly();w.clearInterval(run)})}else if(w.attachEvent){w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}} if(typeof exports!=="undefined"){exports.loadCSS=loadCSS} else{w.loadCSS=loadCSS}}(typeof global!=="undefined"?global:this)) </script></head><body class="site"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KDHGNV6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) --><header class="header" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation"><div class="container"><div class="header__inner"> <a class="header__logo" href="/"><div class="header__logo--container"> <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 294.779 205.349"><defs><style>.cls-1{fill:#fff;}.cls-2{font-size:28px;font-family:Roboto-Medium, Roboto;font-weight:500;}</style></defs><path d="M177.284,200.364a80.333,80.333,0,0,0-16.5,6c-7.8,3.9-11,6.2-18.1,13.3-13.9,14-20.2,29.2-20.3,49.1-.1,12.8,1.3,18.7,7,30.8,14,29.2,47.8,45.1,78.9,37.2,14.7-3.8,29-13.2,44-29.2l7.5-8,7.5,8c15,16,29.3,25.4,44,29.2,36.3,9.3,74.5-13.9,84.2-51,2.3-8.7,2.3-25.3,0-34a95.883,95.883,0,0,0-5.9-15c-7.7-15.8-24.3-29.6-42.2-35.2-8.1-2.5-22.4-3.4-31.1-1.9-15.9,2.8-33.4,12.5-48.4,26.8l-8.2,7.9-8.1-7.9C228.184,203.964,203.384,195.164,177.284,200.364Z" transform="translate(-112.404 -133.469)"/><path class="cls-1" d="M348.384,203.264c19.3,6.4,32.8,18.5,41.5,37,5.9,12.7,7.6,25.5,4.6,34.1-5.4,15.2-15,23.1-32.5,27-8.8,2-28.4,1.5-34.7-.8l-3.9-1.5,5.4-.7c24.7-3.2,35.2-32.1,18.2-50a34.28,34.28,0,0,0-17.9-9.2c-9-1.3-20,5-34.7,20.1l-8.1,8.3-8.1-10.1c-4.5-5.6-10.3-12.8-12.9-16l-4.8-5.8,5.9-6c14.7-15,32.2-25.2,49.5-28.9C323.684,199.164,339.684,200.364,348.384,203.264Z" transform="translate(-112.404 -133.469)"/><path class="cls-1" d="M184.684,227.864a58.838,58.838,0,0,1,21.5,13c3.6,3.3,6.5,6.4,6.4,6.7-.1.4,4.2,5.1,9.5,10.4,5.3,5.4,9.7,10.2,9.7,10.6,0,1.6-11.9,14-18.3,19-9.4,7.4-14.1,9.6-21,9.5-20-.3-33.2-22.4-24.3-40.7,7.8-16,28.2-20.9,40.9-9.8.9.8,2,1.2,2.3.9,1-1-8.1-6.3-13.1-7.7-11.1-3.1-25.7,4.6-31.6,16.8-3.2,6.7-3.2,17.8.1,24.6,5.9,12.2,20.3,19.7,31.7,16.7,6.3-1.7,15.9-8.7,25.8-18.7l9-9.1,9.5,10.4c5.2,5.7,11,12.2,12.9,14.4l3.4,3.9-9.4,9.6c-16.6,16.9-29.3,24.9-44.9,28-38.4,7.7-75.4-19.2-81-58.8-2.3-16.1,3.1-33.1,13.4-42,2.8-2.4,10.1-6.2,15.1-7.8C160.884,224.964,175.784,224.964,184.684,227.864Z" transform="translate(-112.404 -133.469)"/><path class="cls-1" d="M338.484,243.364c9.8,4.7,15.5,13.9,15.5,25.4,0,11.6-5.6,20.6-15.9,25.6-12.8,6.3-22.9,2.7-40-14.2-5.7-5.6-10.3-10.7-10.3-11.4,0-2.1,19.3-20.3,25.3-23.9C322.684,239.264,328.884,238.864,338.484,243.364Z" transform="translate(-112.404 -133.469)"/><text class="cls-2" transform="translate(0 55.323)">Where will you go next?</text><text x="-112.404" y="-133.469"/></svg></div></a><nav class="header__links"><div class="container header__links-wrapper"> <a class="header__link" href="/" itemprop="url"> <span itemprop="name">Home</span> </a> <a class="header__link" href="/about" itemprop="url"> <span itemprop="name">About</span> </a> <a class="header__link" href="/categories" itemprop="url"> <span itemprop="name">Categories</span> </a> <a class="header__link" href="/contact" itemprop="url"> <span itemprop="name">Contact</span> </a></div></nav><div class="header__toggle"> <span></span> <span></span> <span></span></div></div></div></header><div class="hero lazyload" data-bg="http://localhost:4000/assets/img/posts/dual-numbers.jpg"><div class="hero__wrap"><div class="hero__categories"> <a class="label" href="/categories/#Number Theory">Number Theory</a></div><h1 class="hero__title">Dual Numbers and Automatic Differentiation</h1><p class="hero__meta"> <span> <time>17 Jan 2022</time>&nbsp;&middot; </span> <span> 16 mins read </span></p></div></div><main class="site__content"><div class="container"><article class="post-content" itemprop="articleBody"><p>An homage to Matt and Swarthmore.</p><h1 id="background">Background</h1><p>This has actually been a long time coming. I first touched this file for this blog post and dated it <code class="language-plaintext highlighter-rouge">2018-05-17-duals.md</code>. Which is awhile ago. But I am finalllllly getting back to it.</p><p>I distinctively remember this topic first getting introduced in the spring of 2016 <a href="https://mzucker.github.io/swarthmore/">Matt Zucker</a> in Numerical Methods. I think - if i recall correctly - that it was a one day aside basically just to show us a different vector space of our normal mathematical field (like real numbers and the such). I was blown away because basically what it offered was automatic differentiation. To me, it literally looked like Matt was doing magic up there. And he kind of was, enchanting a class like that. But it turns out that now this type of number system is used in Tensorflow and Keras and other computing platforms to expedite differentiation. It’s a really interesting different type of number system to work with.</p><h1 id="code">Code</h1><p><span style="color:blue">Note, if you’re just interested in code, you can skip all this and check out <a href="https://github.com/johnlarkin1/duals/blob/main/duals.py">this repo</a>.</span></p><h1 id="mathematical-introduction">Mathematical Introduction</h1><p>Ok so! There’s a really good relatively quick introduction video <a href="https://www.youtube.com/watch?v=4nU-09e3iP8">here</a>. Also ironically enough, that video is pretty recent. However, I’m going to put it in my own words as both a visual refresher and a refresher for myself.</p><p>We’re going to define duals as the set of numbers \(a + b \varepsilon\) where \(a\) and \(b\) are real numbers.</p><p>This epsilon is going to have one (maybe two) overarching principles to allow us to unlock this number space.</p><ol><li> \[{\varepsilon}^2 = 0\]</li><li> \[\frac{\varepsilon}{\varepsilon} = 1\]</li></ol><p>The premise that we’re going to assert is that this \(\varepsilon\) is going to be a number that is extremely small, and so that when it’s squared, it’s equal to zero. This is going to be a number system that pins itself on that assumption.</p><p>Now there’s a whole lot more to this in terms of number theory and abstract algebra that I’m not going to get into here. Wikipedia has a quote saying:</p><blockquote><p>In abstract algebra, the algebra of dual numbers is often defined as the quotient of a polynomial ring over the real numbers \({\displaystyle (\mathbb {R} )}\) by the principal ideal generated by the square of the indeterminate</p></blockquote><p>Which is a bit outside of my pay grade… I don’t know anything about <a href="https://en.wikipedia.org/wiki/Quotient_ring">quotient rings</a>, but the polynomial ring seems to be a ring (basically a field of math) with one or more indeterminates in one ring, and coefficients in another ring. That makes sense to be given that we’re combining numbers between the real number system and our new dual number system.</p><p>You’ll also note that this is <strong>really</strong> similar to the imaginary number system. The basic difference is that in imaginary systems we have \(i^2 = -1\) whereas with dual numbers we have \({\varepsilon}^2 = 0\).</p><h3 id="benefits">Benefits</h3><p>What’s the benefit? Well we’re going to show it down below, but the real benefit is that we can evaluate a derivative at a point instantaneously and without any algebra. This is an incredibly powerful tool.</p><h1 id="operations">Operations</h1><h3 id="addition">Addition</h3><p>Similar to imaginary numbers, we can simply add component wise. So</p>\[\begin{align*} d_1 &amp;= a_1 + b_1 \varepsilon \\ d_2 &amp;= a_2 + b_2 \varepsilon \\ d_1 + d_2 &amp;= (a_1 + a_2) + (b_1 + b_2) \varepsilon \end{align*}\]<h3 id="multiplication">Multiplication</h3><p>This is where it starts to get fun.</p>\[\begin{align*} d_1 &amp;= a_1 + b_1 \varepsilon \\ d_2 &amp;= a_2 + b_2 \varepsilon \\ d_1 \cdot d_2 &amp;= (a_1 \cdot a_2) + (a_1 \cdot b_2 + a_2 \cdot b_1)\varepsilon + (b_1 \cdot b_2) \varepsilon^2 \\ d_1 \cdot d_2 &amp;= (a_1 \cdot a_2) + (a_1 \cdot b_2 + a_2 \cdot b_1)\varepsilon &amp;&amp; \text{ because of } \varepsilon^2 = 0 \end{align*}\]<h3 id="subtraction">Subtraction</h3><p>Similar to addition:</p>\[\begin{align*} d_1 &amp;= a_1 + b_1 \varepsilon \\ d_2 &amp;= a_2 + b_2 \varepsilon \\ d_1 - d_2 &amp;= (a_1 - a_2) + (b_1 - b_2) \varepsilon \end{align*}\]<h3 id="division">Division</h3><p>So this was interesting, because I didn’t remember this from school, but Wikipedia had a good idea. It makes sense to multiply by the conjugate and you get a slightly different expression.</p>\[\begin{align*} d_1 &amp;= a_1 + b_1 \varepsilon \\ d_2 &amp;= a_2 + b_2 \varepsilon \\ \frac{d_1}{d_2} &amp;= \frac{a_1 + b_1\varepsilon }{a_2 + b_2 \varepsilon} \\ &amp;= \frac{(a_1 + b_1\varepsilon)(a_2 - b_2 \varepsilon)}{(a_2 + b_2 \varepsilon)(a_2 - b_2 \varepsilon)} \\ &amp;= \frac{a_1 a_2 + (a_2 b_1 - a_1 b_2)\varepsilon - b_1 b_2 \varepsilon^2 } {a_2^2 + a_2 b_2 \varepsilon - a_2 b_2 \varepsilon - b_2^2 \varepsilon^2 } \\ &amp;= \frac{a_1 a_2 + (a_2 b_1 - a_1 b_2)\varepsilon - \color{red}{b_1 b_2 \varepsilon^2 }} {a_2^2 + \color{red}{a_2 b_2 \varepsilon} - \color{red}{a_2 b_2 \varepsilon} - \color{red}{b_2^2 \varepsilon^2 }} \\ &amp;= \frac{a_1 a_2 + (a_2 b_1 - a_1 b_2)\varepsilon} {a_2^2 } \\ &amp;= \frac{a_1}{a_2} + \frac{a_2 b_1 - a_1 b_2}{a_2^2} \varepsilon \end{align*}\]<h3 id="exponents">Exponents</h3><p>This is another kind of interesting area where I had to think about it and actually broke out some pen and paper, before realizing the solution.</p><p>So how do we handle raising a dual number to a set power? Well… we really only have to worry about the first two terms right? If we know that \(\varepsilon^2\) is going to be zero, then we really only need to worry about the real portion and then when \(\varepsilon\) is raised to the first power. Everything else (\(\varepsilon^2\), \(\varepsilon^3\), and so forth) are just going to cancel out to zero. Beautiful. It’s really going to be the first derivative. So we can generalize:</p>\[\begin{align*} d^n &amp;= (a + b \varepsilon)^n \\ &amp;= \binom{n}{0} a^n (b\varepsilon)^0 + \binom{n}{1}a^{n-1}b\varepsilon + \binom{n}{2}a^{n-2}(b\varepsilon)^2 + \binom{n}{3}a^{n-3}(b\varepsilon)^3 + \ldots \\ &amp;= \binom{n}{0}a^n (b\varepsilon)^0 + \binom{n}{1}a^{n-1}b\varepsilon + \color{red}{\binom{n}{2}a^{n-2}(b\varepsilon)^2} + \color{red}{\binom{n}{3}a^{n-3}(b\varepsilon)^3} + \color{red}{\ldots} \\ &amp;= \binom{n}{0}a^n (b\varepsilon)^0 + \binom{n}{1}a^{n-1}b\varepsilon \\ &amp;= \frac{n!}{0!(n-0)!}a^n \cdot 1 + \frac{n!}{1!(n-1)!}a^{n-1}b\varepsilon \\ &amp;= \frac{n!}{n!}a^n + \frac{n \cdot (n-1)!}{(n-1)!}a^{n-1}b\varepsilon \\ &amp;= \color{red}{\frac{n!}{n!}}a^n + \frac{n \cdot \color{red}{(n-1)!}}{\color{red}{(n-1)!}}a^{n-1}b\varepsilon \\ &amp;= a^n + na^{n-1}b\varepsilon \\ \end{align*}\]<h1 id="derivatives">Derivatives</h1><p>Let’s look at this formally.</p><p>The formal definition of a derivative</p>\[f'(x) = \lim_{h\to0} \frac{f(x+h) - f(x)}{h}\]<p>but here’s where we get to play games! We <strong>do not need to take a limit!!</strong>. This is crazy. \(\varepsilon\) is doing the work of being an infitesimally small number approaching zero. So we can basically rewrite this as:</p>\[f'(x) = \frac{f(x+\varepsilon) - f(x)}{x + \varepsilon - x}\]<p>But… we’re still dividing by <em>basically</em> a zero divider. And this is where we have to play the game of clearing out these \(\varepsilon\)s as early as possible.</p><p>So let’s continue and give a real function.</p>\[f(x) = x^2\]<p>Then our derivative becomes</p>\[f'(x) = \frac{(x+\varepsilon)^2 - x^2}{\varepsilon} = \frac{2x\varepsilon}{\varepsilon} = 2x\]<p>Which is perfect because that’s right! That’s the right derivative.</p><h3 id="pitfalls">Pitfalls</h3><p>Ok well that’s great, but then are you asking yourself, why aren’t these used everywhere? Well, there’s a bit of a cornercase, because we’re actually playing games with division by zero and skirting around some laws of math.</p><p>Apparently, both Newton and Leibniz didn’t love the approach of squaring a small number and saying that it’s directly equal to zero… which is very fair because it’s not. Their approach hinged a lot more on limits as epsilon approaches zero in order to calculate a derivative for example. They’re basically introducing a time impact because we’re <em>approaching</em> zero not just zero. But their fears are definitely valid. A good counterpoint example brought up in <a href="https://www.youtube.com/watch?v=4nU-09e3iP8">this video</a> is as follows. Let’s look at some function composition.</p>\[f(g(x))\]<p>Then the derivative is just</p>\[f'(g(x))g'(x)\]<p>Let’s set \(f(x)=g(x)=x^2\).</p>\[\begin{align*} f'(g(x))g'(x) &amp;= \frac{(x^2+\varepsilon)^2 - (x^2)^2}{\varepsilon} \frac{(x+\varepsilon)^2 - x^2}{\varepsilon} \\ \tag{1} f'(g(x))g'(x) &amp;= \frac{2x^2\varepsilon}{\varepsilon} \frac{2x\varepsilon}{\varepsilon} \end{align*}\]<p><strong>NOW</strong>… If we choose to clear the \(\varepsilon\)s immediately, then we look good right?</p>\[\begin{align*} f'(g(x))g'(x) &amp;= \frac{2x^2\color{red}{\varepsilon}}{\color{red}{\varepsilon}}\frac{2x\color{red}{\varepsilon}}{\color{red}{\varepsilon}} \\ f'(g(x))g'(x) &amp;= 2x^2 \cdot 2x \\ f'(g(x))g'(x) &amp;= 4x^3 \end{align*}\]<p>which is great, because once again that’s correct! However…. What happens if we don’t cancel out our \(\varepsilon\)s and we factor everything out? Which should abide by normal algebraic manipulation as well. Let’s jump back to equation (1) and not clear out our \(\varepsilon\).</p>\[\begin{align*} \tag{1} f'(g(x))g'(x) &amp;= \frac{2x^2\varepsilon}{\varepsilon} \frac{2x\varepsilon}{\varepsilon} \\ f'(g(x))g'(x) &amp;= \frac{ 4x^3\varepsilon^2}{\varepsilon^2} \end{align*}\]<p><span style="color:red"><b>UH OH</b></span>. Here’s where we run into our error… Because we can’t divide by zero! So this is a slight break. This implicitly requires a specific order in terms of clearing out the \(\varepsilon\). You don’t know that they were actually the same \(\varepsilon\), so this clearing rule is a bit tricky to actually apply. <strong>So</strong> this is part of the caveat when working with duals.</p><h1 id="real-world-example">Real World Example</h1><p>So the real power comes in when we’re given a function, and a point, and we want to automatically know the function value and the the derivative at that point. All in one step.</p><p>Let’s look at \(f(x) = x^2 + 7x - 18\) and evaluate the function at \(f(7)\). Totally made up function.</p><p>\(\begin{align*} f(x) &amp;= x^2 + 7x - 18 \\ f(7) &amp;= 7^2 + 7\cdot7 - 18 &amp;&amp; \text{conver to dual first!} \\ f(7 + \varepsilon) &amp;= (7 + \varepsilon)^2 + 7\cdot(7 + \varepsilon) - 18 &amp;&amp; \text{reminder, we're basically adding 0 so it's fine!} \\ &amp;= 49 + 14 \varepsilon + \varepsilon^2 + 49 + 7\varepsilon - 18 \\ &amp;= 80 + 21 \varepsilon \\ \end{align*}\).</p><p>Beautiful! Instantaneous value and derivative (in this case slope). And grab a calculator or go to <a href="https://www.wolframalpha.com/">Wolfram Alpha</a>. You can also get the value <a href="https://www.wolframalpha.com/input/?i=x**2+%2B+7*x+-+18+at+x%3D7+">here</a> and slope <a href="https://www.wolframalpha.com/input/?i=x**2+%2B+7*x+-+18+slope+at+x%3D7+">here</a>. Also to prove I’m not lying!</p><p><img src="/images/duals/value.png" alt="value" class="center-shrink" /> <img src="/images/duals/slope.png" alt="slope" class="center-shrink" /></p><h1 id="code-1">Code</h1><p>But obviosuly, why are we here?! The code!! So check out this whole example and a relatively nice (don’t love using <code class="language-plaintext highlighter-rouge">eval</code> (if you use it be cautious about performance! I just did it to get the printing functionality of the functions definition without using <code class="language-plaintext highlighter-rouge">inspect</code>)).</p><p>The code is linked <a href="https://github.com/johnlarkin1/duals/blob/main/duals.py">here</a>, but I’m also going to put the whole thing here because it’s not too long.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Class to demonstrate the power of duals"""</span>


<span class="k">class</span> <span class="nc">Dual</span><span class="p">:</span>
    <span class="s">"""Class to implement Duals. For more information, see https://en.wikipedia.org/wiki/Dual_number"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real_part</span><span class="p">,</span> <span class="n">dual_part</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">=</span> <span class="n">real_part</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span> <span class="o">=</span> <span class="n">dual_part</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Dual</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">+</span> <span class="n">other</span><span class="p">.</span><span class="n">real_part</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span> <span class="o">+</span> <span class="n">other</span><span class="p">.</span><span class="n">dual_part</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="c1"># Just assume that they only want the real_part
</span>            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">+</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">).</span><span class="n">__name__</span><span class="si">}</span><span class="s"> type not defined for addition with duals"</span>
        <span class="p">)</span>

    <span class="n">__radd__</span> <span class="o">=</span> <span class="n">__add__</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Dual</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">real_part</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">dual_part</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">-</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">).</span><span class="n">__name__</span><span class="si">}</span><span class="s"> type not defined for subtraction with duals"</span>
        <span class="p">)</span>

    <span class="n">__rsub__</span> <span class="o">=</span> <span class="n">__sub__</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># Check if it's a dual, otherwise handle it like normal scalar operation
</span>        <span class="c1"># If it's not a number, raise.
</span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Dual</span><span class="p">):</span>
            <span class="c1"># Foil baby
</span>            <span class="c1"># (a + b\eps) * (c + d\eps) = (a*c) + (c*b\eps) + (a*d\eps) + (b*d)(\eps)**2
</span>            <span class="c1"># But oh snap! Apply \eps**2 == 0
</span>            <span class="c1"># (a*c) + (c*b\eps) + (a*d\eps)
</span>            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">*</span> <span class="n">other</span><span class="p">.</span><span class="n">real_part</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span> <span class="o">+</span> <span class="n">other</span><span class="p">.</span><span class="n">dual_part</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">*</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span> <span class="o">*</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">).</span><span class="n">__name__</span><span class="si">}</span><span class="s"> type not defined for multiplciation with duals"</span>
        <span class="p">)</span>

    <span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>

    <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Dual</span><span class="p">):</span>
            <span class="n">dual_numerator</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span> <span class="o">*</span> <span class="n">other</span><span class="p">.</span><span class="n">real_part</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">dual_part</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">real_part</span>
            <span class="p">)</span>
            <span class="n">dual_denominator</span> <span class="o">=</span> <span class="n">other</span><span class="p">.</span><span class="n">real_part</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">/</span> <span class="n">other</span><span class="p">.</span><span class="n">real_part</span><span class="p">,</span> <span class="n">dual_numerator</span> <span class="o">/</span> <span class="n">dual_denominator</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">/</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">).</span><span class="n">__name__</span><span class="si">}</span><span class="s"> type not defined for division with duals"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Dual</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">other</span><span class="p">.</span><span class="n">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span><span class="n">other</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">real_part</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">).</span><span class="n">__name__</span><span class="si">}</span><span class="s"> type not defined for division with duals"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># Just take into account the binomail expansion
</span>        <span class="c1"># but the beauty is we only need to worry about the first two terms.
</span>        <span class="c1"># Only works for numbers... don't wanna think about raising a dual to a dual
</span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Dual</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">**</span> <span class="n">other</span><span class="p">,</span>
                <span class="n">other</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">real_part</span> <span class="o">**</span> <span class="p">(</span><span class="n">other</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">).</span><span class="n">__name__</span><span class="si">}</span><span class="s"> not defined for power with duals. Only int/float"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"(</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">real_part</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">dual_part</span><span class="si">}</span><span class="se">\u03B5</span><span class="s">)"</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">__str__</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">value_and_derivative_at_point</span><span class="p">(</span><span class="n">function_to_eval</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
    <span class="s">"""Wrapper around function to invoke and print helpful dual results"""</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">function_to_eval</span><span class="p">.</span><span class="n">function</span><span class="p">(</span><span class="n">Dual</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">value</span><span class="p">,</span> <span class="n">deriv</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="n">real_part</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">dual_part</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"For function </span><span class="si">{</span><span class="n">function_to_eval</span><span class="si">}</span><span class="s">, f(</span><span class="si">{</span><span class="n">point</span><span class="si">}</span><span class="s">)=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s">, f'(</span><span class="si">{</span><span class="n">point</span><span class="si">}</span><span class="s">)=</span><span class="si">{</span><span class="n">deriv</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">deriv</span>


<span class="k">class</span> <span class="nc">GeneralFunction</span><span class="p">:</span>
    <span class="s">"""Abusing eval so we can see our function definition"""</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">definition</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">definition</span> <span class="o">=</span> <span class="n">definition</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">definition</span>

    <span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="s">"""Evaluate our expression. Note, x (arg1) is used in the expression."""</span>
        <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">definition</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">Dual</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">Dual</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"x: </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"y: </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"x + y : </span><span class="si">{</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"y + x : </span><span class="si">{</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"x * y : </span><span class="si">{</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"y * x : </span><span class="si">{</span><span class="n">y</span> <span class="o">*</span> <span class="n">x</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"x - y : </span><span class="si">{</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"y - x : </span><span class="si">{</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"x / y : </span><span class="si">{</span><span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"y / x : </span><span class="si">{</span><span class="n">y</span> <span class="o">/</span> <span class="n">x</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

    <span class="n">func</span> <span class="o">=</span> <span class="n">GeneralFunction</span><span class="p">(</span><span class="s">"x**2 + 7*x - 18"</span><span class="p">)</span>
    <span class="n">value_and_derivative_at_point</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</code></pre></div></div><h3 id="useful-resources">Useful Resources</h3><p>Here are a couple of other useful links I used to read up on Duals</p><ul><li><a href="http://www.ams.org/publicoutreach/feature-column/fc-2017-12">American Mathematical Society</a></li><li><a href="https://blog.demofox.org/2014/12/30/dual-numbers-automatic-differentiation/">Demo Fox Blog</a></li><li><a href="https://alemorales.info/post/automatic-differentiation-with-dual-numbers/">Morales Blog</a></li></ul><h3 id="notes">Notes:</h3><p>I couldn’t find a clean way to include a Latex package in Markdown so I was forced to use coloring to denote cancelling, but a better route would be to use the <code class="language-plaintext highlighter-rouge">ulem</code> latex package.</p></article><div class="post-content controls__inner"><div class="controls__item prev"> <span>Previous</span> <a href="/2022/year-in-review/"> <span> <svg xmlns="http://www.w3.org/2000/svg" width="6" height="11"><path fill="fillColor" d="M5.647 1.718c.37-.434.323-1.09-.106-1.465A1.016 1.016 0 0 0 4.095.36L.25 4.875a1.05 1.05 0 0 0 .017 1.378l3.95 4.407c.38.424 1.03.456 1.448.07a1.05 1.05 0 0 0 .07-1.468l-3.34-3.725 3.253-3.819z"/> </svg> </span> 2021 - A Year in Review </a></div><div class="controls__item next"> <span>Next</span> <a href="/2022/blog-revamp/"> The Blog Reborn <span> <svg xmlns="http://www.w3.org/2000/svg" width="6" height="11"><path fill="#fillColor" d="M.353 9.282c-.37.434-.323 1.09.106 1.465a1.016 1.016 0 0 0 1.446-.107L5.75 6.125a1.05 1.05 0 0 0-.017-1.378L1.784.34A1.015 1.015 0 0 0 .336.27a1.05 1.05 0 0 0-.07 1.468l3.34 3.725L.353 9.282z"/> </svg> </span> </a></div></div></div><div class="comments"><div class="container"><div class="post-content"><div id="disqus_thread"></div><script> var disqus_config = function () { this.page.url = 'http://localhost:4000/2022/dual-numbers/'; this.page.identifier = 'http://localhost:4000/2022/dual-numbers/'; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://jlarks32.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the comments.</noscript></div></div></div></main><footer class="footer"><div class="container"><nav class="social"> <a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/johnlarkin1"> <svg class="social__icon" viewBox="0 0 20 20" width="20px" height="20px"><path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg> </a></nav><span>&copy; 2023 Where will you go next?. All rights reserved.</span></div></footer><script async src="/assets/js/bundle.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } }); </script> <script type="text/javascript" charset="utf-8" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" > </script> <script type="text/javascript" charset="utf-8" src="https://vincenttam.github.io/javascripts/MathJaxLocal.js" > </script></body></html>
